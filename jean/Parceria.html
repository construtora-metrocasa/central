<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jean</title>
<link rel="icon" href="icon.png" type="image/png">

<style>
html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    font-family: Arial, sans-serif;
    background: #000;
}

iframe {
    border: none;
}

/* Mensagem de boas-vindas */
#bemVindo {
    position: fixed;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 9999;
    background: rgba(255,255,255,0.9);
    padding: 12px 20px;
    border-radius: 8px;
    color: #333;
    font-size: 1.2em;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    opacity: 0;
    transition: opacity 1s;
}

/* ------- CARROSSEL ------- */
#carousel {
    display: flex;
    width: 200vw; /* 2 slides */
    height: 100vh;
    transition: transform 0.6s ease;
}

.slide {
    width: 100vw;
    height: 100vh;
}

.slide iframe {
    width: 100%;
    height: 100%;
}

/* Setas */
.arrow {
    position: fixed;
    top: 50%;
    transform: translateY(-50%);
    font-size: 2rem; /* menor */
    color: white;
    padding: 8px 14px;
    background: rgba(0,0,0,0.25); /* mais translucido */
    border-radius: 50%;
    cursor: pointer;
    z-index: 9999;
    user-select: none;
    opacity: 0.5; /* transparência */
    transition: opacity .3s;
}

.arrow:hover {
    opacity: 1; /* aparece mais no hover */
    background: rgba(0,0,0,0.4);
}

#prev { left: 10px; }
#next { right: 10px; }

.arrow.hidden {
    display: none; /* seta some */
}
</style>
</head>
<body>

<h2 id="bemVindo"></h2>

<!-- CARROSSEL -->
<div id="carousel">
    <!-- Slide 1 -->
    <div class="slide">
        <iframe src="https://app.powerbi.com/view?r=eyJrIjoiZWUzODcwOTMtMmE4Yy00MmZmLWE2YTktODY3ZmI1NDc0NTU0IiwidCI6ImM3NGViY2JkLWE4MGYtNDYwYy1hMDUzLTEwZDViNmY1ZWQwNSJ9"></iframe>
    </div>

    <!-- Slide 2 -->
    <div class="slide">
        <iframe src="https://app.powerbi.com/view?r=eyJrIjoiNTY3MGI1ODAtOWIwYi00ZjJjLWE4ZDMtNzJlYjViYTM5YjQwIiwidCI6ImM3NGViY2JkLWE4MGYtNDYwYy1hMDUzLTEwZDViNmY1ZWQwNSJ9"></iframe>
    </div>
</div>

<!-- SETAS -->
<div id="prev" class="arrow">&#10094;</div>
<div id="next" class="arrow">&#10095;</div>

<script>
// ---------------- Cookie ----------------
function getCookie(nome) {
    const match = document.cookie.match(new RegExp('(^| )' + nome + '=([^;]+)'));
    return match ? decodeURIComponent(match[2]) : null;
}

// ---------------- Registro no Google Sheets ----------------
async function registrarAcesso(usuario) {
    const apiUrl = "https://script.google.com/macros/s/AKfycbw8L0ZxkZxQ6E7BuqNPJDlr_xZTBVP12I8duKiU-Us1bS5slw7UJp_obNTrv2KuAuo/exec";
    const dispositivo = navigator.userAgent;
    const horario = new Date().toISOString();
    const link = window.location.href;

    let ip = "";
    try {
        const r = await fetch("https://api.ipify.org?format=json");
        ip = (await r.json()).ip;
    } catch(e){}

    fetch(apiUrl, {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ usuario, link, horario, dispositivo, ip })
    });
}

// ---------------- Solicitar nome ----------------
function solicitarNomeERegistrar() {
    const usuario = prompt("Digite seu nome para acessar:") || "Desconhecido";
    document.cookie = `usuario=${encodeURIComponent(usuario)}; path=/; max-age=${60*60*24*365}; SameSite=Lax`;
    registrarAcesso(usuario);
    return usuario;
}

// ---------------- Carregamento da página ----------------
window.onload = function() {
    let usuario = getCookie("usuario");
    const bemVindo = document.getElementById("bemVindo");

    if(usuario){
        bemVindo.innerText = `Bem-vindo de volta, ${usuario}!`;
        registrarAcesso(usuario);
    } else {
        usuario = solicitarNomeERegistrar();
        bemVindo.innerText = `Bem-vindo, ${usuario}!`;
    }

    // Mostrar mensagem temporária
    bemVindo.style.opacity = "1";
    setTimeout(() => {
        bemVindo.style.opacity = "0";
    }, 3000);
};

// ---------------- Carrossel ----------------
let index = 0;

function updateArrows() {
    const prev = document.getElementById("prev");
    const next = document.getElementById("next");
    const total = document.querySelectorAll(".slide").length;

    prev.classList.toggle("hidden", index === 0);
    next.classList.toggle("hidden", index === total - 1);
}

function showSlide(i) {
    const slides = document.querySelectorAll(".slide");
    index = Math.max(0, Math.min(i, slides.length - 1));
    document.getElementById("carousel").style.transform = `translateX(-${index * 100}vw)`;
    updateArrows();
}

document.getElementById("next").onclick = () => showSlide(index + 1);
document.getElementById("prev").onclick = () => showSlide(index - 1);

updateArrows(); // inicial
</script>

</body>
</html>
